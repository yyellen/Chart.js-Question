<!doctype html>
<html lang="en">
  <head>
    <title>全國-教育金字塔</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS v5.0.2 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <canvas id="myChart" width="800" height="600"></canvas>

    <script>
    var ctx = document.getElementById('myChart');
    
    // male datapoint converter
    const male = [189, 2076, 7887,3687, 691, 45, 36, 20];
    const maleData = [];
    male.forEach(element => maleData.push(element * -1));
    console.log(maleData);

    const labels = ["博士","碩士", "學士", "專科", "高中", "國中", "國小", "其他"];
    const data = {
                labels: labels,
                datasets: [
                  {
                    label: '男性',
                    data: maleData,
                    backgroundColor:
                    [
                        'rgba(54, 162, 235)',
                    ],
                    borderColor: 
                    [
                        'rgb(54, 162, 235)',
                    ],
                        borderWidth: 1
                },
                {
                    label: '女性',
                    data: [85, 1401, 8330, 3324, 609, 40, 30, 25],
                    backgroundColor:
                    [
                        'rgba(255, 99, 132)',
                    ],
                    borderColor: 
                    [
                        'rgb(255, 99, 132)',
                    ],
                        borderWidth: 1
                },
                ]
    };

    // block tooltip
    const tooltip = {
      yAlign: 'bottom',
      titleAlign: 'center',
      callbacks: {
        label: function(context) {
          console.log(context.raw);
          console.log(context.dataset.label);
          return `${context.dataset.label} ${Math.abs(context.raw)}`;
        }
      }
    };

    const config = {
        	type: 'bar',
        	data: data,
        	options: {
              categoryPercentage: 1.0,
              barPercentage: 0.98,

            	maintainAspectRatio: false,
              indexAxis: 'y',
            	scales: {
                	x: {
                    stacked: true,
                    ticks: {
                      callback: function(value, index, values) {
                        return Math.abs(value);
                      }
                    }
                  },
                  y: {
                    	beginAtZero: true,
                      stacked: true
                	},
            	},
              plugins: {
                tooltip,
              }
        	}
    };

    const myChart = new Chart(ctx, config);

    </script>
    <!-- Bootstrap JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
  </body>
</html>